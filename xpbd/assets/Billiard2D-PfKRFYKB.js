var X=Object.defineProperty;var Y=(d,t,e)=>t in d?X(d,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):d[t]=e;var f=(d,t,e)=>(Y(d,typeof t!="symbol"?t+"":t,e),e);import{C as F,u as k}from"./CanvasResizer-LEQHF3FN.js";import{h as D,i as g,j as T,o as W,c as I,f as _,F as P}from"./vendor-8o0RFIkR.js";function R(d,t){return d*d>t*t?d:t}function H(d,t){return d*d<t*t?d:t}const L=1e-4;class a{constructor(t,e){f(this,"_elements");f(this,"_dimension");this._dimension=t;let n=0;if(e===void 0)for(this._elements=new Array(t),n=0;n<t;n++)this._elements[n]=0;else for(this._elements=new Array(t),n=0;n<e.length;n++)this._elements[n]=e[n]}set(t){if(t!==void 0){if(t.size()!==this.size())return console.log("dimension is not correct!"),!1;for(let e=0;e<t.size();e++)this._elements[e]=t.data()[e];return!0}return!1}_fill(t){const e=new Array(this._dimension);return e.fill(t),new a(this._dimension,e)}ones(){return this._fill(1)}zeros(){return this._fill(0)}setZero(){this._elements.fill(0)}setOne(){this._elements.fill(1)}setValues(t){this._elements.fill(t)}data(){return this._elements}clone(){return new a(this._dimension,this._elements)}at(t){return t<0||t>=this.size()?(console.log("index is not correct!"),-1):this._elements[t]}dot(t){if(t===void 0)return console.log("others is not correct!"),-1;if(t.size()!==this.size())return console.log("dimension is not correct!"),-1;let e=0;for(let n=0;n<this.size();n++)e+=this._elements[n]*t.data()[n];return e}lengthSquared(){return this.dot(this)}length(){return Math.sqrt(this.lengthSquared())}normalize(){this.idiv(this.length())}normalized(){return this.div(this.length())}sum(){let t=0;for(let e=0;e<this._dimension;e++)t+=this._elements[e];return t}size(){return this._dimension}avg(){return this.sum()/this.size()}min(){let t=this._elements[0];for(let e=1;e<this._dimension;e++)t=Math.min(t,this._elements[e]);return t}max(){let t=this._elements[0];for(let e=1;e<this._dimension;e++)t=Math.max(t,this._elements[e]);return t}absmax(){let t=this._elements[0];for(let e=1;e<this._dimension;e++)t=R(t,this._elements[e]);return t}absmin(){let t=this._elements[0];for(let e=1;e<this._dimension;e++)t=H(t,this._elements[e]);return t}distanceSquaredTo(t){if(t.size()!==this.size())return console.log("dimension is not correct!"),-1;let e=0;for(let n=0;n<this.size();n++){const s=this._elements[n]-t.data()[n];e+=s*s}return e}distanceTo(t){return Math.sqrt(this.distanceSquaredTo(t))}isEqual(t){if(this.size()!==t.size())return!1;for(let e=0;e<this.size();e++)if(this.at(e)!==t.at(e))return!1;return!0}isSimilar(t,e=L){if(t===void 0||this.size()!==t.size())return!1;for(let n=0;n<this.size();n++)if(Math.abs(this.at(n)-t.at(n))>e)return!1;return!0}add(t){let e=0;if(typeof t=="object"){const n=t;if(n.size()!==this.size())return new a(1,[-1]);const s=new a(this.size(),this.data());for(e=0;e<s.size();e++)s.data()[e]+=n.data()[e];return s}else if(typeof t=="number"){const n=t,s=new a(this.size(),this.data());for(e=0;e<s.size();e++)s.data()[e]+=n;return s}return new a(1,[-1])}sub(t){let e=0;if(typeof t=="object"){const n=t;if(n.size()!==this.size())return new a(1,[-1]);const s=new a(this.size(),this.data());for(e=0;e<s.size();e++)s.data()[e]-=n.data()[e];return s}else if(typeof t=="number"){const n=t,s=new a(this.size(),this.data());for(e=0;e<s.size();e++)s.data()[e]-=n;return s}return new a(1,[-1])}mul(t){let e=0;if(typeof t=="object"){const n=t;if(n.size()!==this.size())return new a(1,[-1]);const s=new a(this.size(),this.data());for(e=0;e<s.size();e++)s.data()[e]*=n.data()[e];return s}else if(typeof t=="number"){const n=t,s=new a(this.size(),this.data());for(e=0;e<s.size();e++)s.data()[e]*=n;return s}return new a(1,[-1])}div(t){let e=0;if(typeof t=="object"){const n=t;if(n.size()!==this.size())return new a(1,[-1]);const s=new a(this.size(),this.data());for(e=0;e<s.size();e++)s.data()[e]/=n.data()[e];return s}else if(typeof t=="number"){const n=t;if(n===0)return new a(1,[-1]);const s=new a(this.size(),this.data());for(e=0;e<s.size();e++)s.data()[e]/=n;return s}return new a(1,[-1])}idiv(t){this.set(this.div(t))}iadd(t){this.set(this.add(t))}isub(t){this.set(this.sub(t))}imul(t){this.set(this.mul(t))}rsub(t){let e=0;if(typeof t=="object"){const n=t;if(n.size()!==this.size())return new a(1,[-1]);const s=new a(this.size(),n.data());for(e=0;e<s.size();e++)s.data()[e]-=this.data()[e];return s}else if(typeof t=="number"){const n=t,s=new a(this.size(),this.data());for(e=0;e<s.size();e++)s.data()[e]=n-s.data()[e];return s}return new a(1,[-1])}rdiv(t){let e=0;if(typeof t=="object"){const n=t;if(n.size()!==this.size())return new a(1,[-1]);const s=new a(n.size(),n.data());for(e=0;e<s.size();e++)s.data()[e]/=this.data()[e];return s}else if(typeof t=="number"){const n=t;if(n===0)return new a(1,[-1]);const s=new a(this.size(),this.data());for(e=0;e<s.size();e++)s.data()[e]=n/s.data()[e];return s}return new a(1,[-1])}setAt(t,e){if(!(t<0||t>=this.size()))return this._elements[t]=e,!0}static proj(t,e){return t.mul(e.dot(t)/t.dot(t))}forEachData(t){for(let e=0;e<this.size();e++)t(this.at(e))}printVector(){let t="[ ";this.forEachData(e=>{t+=e.toString()+" "}),t+="]",console.log(t)}}class l extends a{constructor(t=0,e=0){super(2,new Array(t,e))}x(){return this.data()[0]}y(){return this.data()[1]}setX(t){this._elements[0]=t}setY(t){this._elements[1]=t}iset(t){this.data()[0]=t.x(),this.data()[1]=t.y()}set(t){return super.set(new a(2,t.data()))}add(t){const e=super.add(t);return new l(e.data()[0],e.data()[1])}sub(t){const e=super.sub(t);return new l(e.data()[0],e.data()[1])}mul(t){const e=super.mul(t);return new l(e.data()[0],e.data()[1])}div(t){const e=super.div(t);return new l(e.data()[0],e.data()[1])}rdiv(t){const e=super.rdiv(t);return new l(e.data()[0],e.data()[1])}dot(t){return super.dot(new a(2,t.data()))}cross(t){return this.x()*t.y()-this.y()*t.x()}normalize(){super.normalize()}normalized(){const t=super.normalized();return new l(t.data()[0],t.data()[1])}tangential(){return new l(this.y(),-this.x())}clone(){return new l(this.x(),this.y())}}const N=_("p",null,"Billiard2D Example",-1),p=2,G=D({__name:"Billiard2D",setup(d){const t=g(null),e=g(null);class n{constructor(r,u,o,h){f(this,"pos");f(this,"vel");f(this,"mass");f(this,"radius");this.radius=r,this.mass=u,this.pos=o.clone(),this.vel=h.clone()}simulate(r,u){this.vel.iadd(u.mul(r)),this.pos.iadd(this.vel.mul(r))}}class s{}f(s,"gravity",new l(0,0)),f(s,"dt",1/60),f(s,"worldSize",new l(1,1)),f(s,"restitution",1),f(s,"balls");const y=(i,r)=>i.x()*r,M=(i,r)=>e.value.height-i.y()*r,x=(i,r)=>{s.balls=new Array;let u=20;for(let o=0;o<u;o++){let h=.05+Math.random()*.1,z=Math.PI*h*h,m=new l(Math.random()*i,Math.random()*r),w=new l(-1+2*Math.random(),-1+2*Math.random());s.balls.push(new n(h,z,m,w))}},j=(i,r)=>{i.clearRect(0,0,e.value.width,e.value.height),i.fillStyle="#FF0000";for(let u=0;u<s.balls.length;u++){let o=s.balls[u];i.beginPath(),i.arc(y(o.pos,r),M(o.pos,r),r*o.radius,0,2*Math.PI),i.closePath(),i.fill()}},B=(i,r,u)=>{let o=r.pos.sub(i.pos),h=o.length();if(h==0||h>i.radius+r.radius)return;o.imul(1/h);let z=(i.radius+r.radius-h)/2;i.pos.iadd(o.mul(-z)),r.pos.iadd(o.mul(z));let m=i.vel.dot(o),w=r.vel.dot(o),c=i.mass,v=r.mass,S=(c*m+v*w-v*(m-w)*u)/(c+v),C=(c*m+v*w-c*(w-m)*u)/(c+v);i.vel.iadd(o.mul(S-m)),r.vel.iadd(o.mul(C-w))},q=(i,r)=>{i.pos.x()<i.radius&&(i.pos.setX(i.radius),i.vel.setX(-i.vel.x())),i.pos.x()>r.x()-i.radius&&(i.pos.setX(r.x()-i.radius),i.vel.setX(-i.vel.x())),i.pos.y()<i.radius&&(i.pos.setY(i.radius),i.vel.setY(-i.vel.y())),i.pos.y()>r.y()-i.radius&&(i.pos.setY(r.y()-i.radius),i.vel.setY(-i.vel.y()))},A=()=>{for(let u=0;u<s.balls.length;u++){var i=s.balls[u];i.simulate(s.dt,s.gravity);for(let o=u+1;o<s.balls.length;o++){var r=s.balls[o];B(i,r,s.restitution)}q(i,s.worldSize)}},E=()=>{const i=e.value;i.height=window.innerHeight,i.width=window.innerWidth};return T(()=>{const i=e.value;i.height=window.innerHeight,i.width=window.innerWidth,i.addEventListener("resize",E,!1),new F(i).resize();const u=Math.min(e.value.width,e.value.height)/p,o=e.value.width/u,h=e.value.height/u;x(o,h)}),k(()=>{const i=e.value.getContext("2d"),r=Math.min(e.value.width,e.value.height)/p,u=e.value.width/r,o=e.value.height/r;return s.worldSize.set(new l(u,o)),A(),j(i,r),!0}),(i,r)=>(W(),I(P,null,[N,_("div",{ref_key:"viewer",ref:t,class:"viewer"},[_("canvas",{id:"cvs",ref_key:"canvas",ref:e,class:"renderer"},null,512)],512)],64))}});export{G as default};
